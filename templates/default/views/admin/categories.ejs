<!DOCTYPE html>
<html>
<%- include('../partials/head.ejs'); %>
<body>
    <%- include('../partials/navbar.ejs'); %>

    <script>
        function validateCategory() {
            if (!name.value) return toast(`No name was entered.`, 'danger');
            if (name.value.length < 1) return toast(`The name must be at least 1 character.`, 'danger');
            
            if (!['category', 'subcategory'].includes(type.value)) return toast(`Type isn't valid, did you inspect element that?`, 'danger');
        }
    </script>

    <div class="header has-background-grey-lighter">
        <div class="container">
            <h1 class="title"><%= locals.title %></h1>
            <p class="subtitle is-6">Manage your forum's content and settings</p>
        </div>
    </div>

    <br />

    <div class="container">
        <div class="columns">
            <div class="column is-2">
                <%- include('../partials/adminMenu.ejs'); %>
            </div>
            <div class="column">
                <h1 class="title">Categories <a class="button is-info is-pulled-right" onclick="openModal('createCategory');"><i class="fas fa-plus"></i></a></h1>
                <p class="subtitle is-6">Manage the categories and sub-categories on your forum</p>

                <% if (!categories.length) { %>
                    <p class="subtitle is-6 has-text-grey">No categories have been created.</p>
                <% } else { %>
                    <article class="message is-info">
                        <div class="message-header">
                            <p>Info</p>
                            <button class="is-info" aria-label="new"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="message-body">
                            <p>Sub-categories will appear here.</p>
                        </div>
                    </article>
                <% } %>
            </div>
        </div>
    </div>

    <div class="modal modal-fx-slideTop" id="modal-createCategory">
        <div class="modal-background" onclick="closeModal('createCategory');"></div>
        <div class="modal-content">
            <div class="box" onsubmit="return validateCategory();">
                <form method="POST" action="/admin/categories/new">
                    <div class="field">
                        <label class="label">Name</label>
                        <div class="control">
                            <input class="input" type="text" name="name" id="name" autocomplete="off" />
                            <input class="input" type="text" name="type" id="type" autocomplete="off" style="display: none !important;" value="category" />
                        </div>
                    </div>

                    <div class="control">
                        <button class="button is-info">Create</button>
                    </div>
                </form>
            </div>
        </div>
        <button class="modal-close is-large" aria-label="close" onclick="closeModal('createCategory');"></button>
    </div>

    <%- include('../partials/scripts.ejs'); %>
</body>
</html>